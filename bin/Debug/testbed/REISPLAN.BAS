10 REM REISROUTE plan programma van G. Rahman (c) 199420 CLEAR200:S$="S=BASIC 3V,RUN"+CHR$(34)+"REISPLAN/BAS"+CHR$(34)30 CLS:ONERRORGOTO40:OPEN"R",3,"BASIC/CMD",1:GOTO5040 CMD S$50 ONERRORGOTO0:GOTO27060 PRINT@PL,CHR$(30);:LINEINPUT"Filename  without extension please ";RT$:IFLEN(RT$)=0ORLEN(RT$)>08THEN91070 IFINSTR(RT$,"/")<>0THEN60ELSERT$=RT$+EX$80 FORI=1TOLEN(RT$):T1$=MID$(RT$,I,1):IFT1$>="a"ANDT1$<="z"THENMID$(RT$,I,1)=CHR$(ASC(T1$)-32):NEXTELSENEXT90 PRINT@PL,CHR$(30);:LINEINPUT"Drive number please (Default is :0)";DR$:DR=VAL(DR$):IFDR<0ORDR>3THEN90100 RETURN110 ONERRORGOTO130120 T$="RENAME "+RT$+" "+RT$:CMD T$130 T=ERR/2+1:IFT<>58THENF=1ELSEF=-1140 RESUME150150 ONERRORGOTO0160 RETURN170 CLOSE FP:OPEN"R",FP,RT$,"FF",64180 RETURN190 JN$="":PRINT@PL,CHR$(30);:INPUT"Druk op <j> en <ENTER> om te bevestigen";JN$:IFJN$="J"ORJN$="j"THENJN=1:RETURNELSEJN=0:RETURN200 IFF=-1THENRETURN210 IFR>=4R=0220 IFR<=4R=R+1230 IFRC>LOF(FP)ORRC<1THENR1$=STR$(RC):PRINT@PR+R*64,LEFT$(R1$,1)+STRING$(3-(LEN(R1$)-1),"0")+RIGHT$(R1$,LEN(R1$)-1);CHR$(30);:GOTO260240 GET FP,RC,,(64)R$;250 PRINT@PR+R*64,R$;260 RETURN270 CLEAR 18000:DEFINT B-F,H-Q,S-Z:DEFSTRC:DEFSNGK:DIM PS(26),D$(255):A=64:N=1:A$=STRING$(11,143):B$="1234567890123":C0=CHR$(149):C1=CHR$(170):PL=896:RC$="xxxxx"280 FORK=1TO4:PS(K)=514+(K-1)*16:PS(K+4)=PS(K)+A:NEXT290 PS(9)=PS(5)+A:PS(13)=PS(9)+A:PS(11)=PS(7)+A:PS(15)=PS(11)+A:PS(19)=PS(15)+A:PS(10)=PS(6)+A:PS(0)=434300 REM wd$ = 58 karakters310 DATA 235,035,094,035,086,235,086,035,094,035,070,035,078320 DATA 035,175,203,058,031,203,058,031,131,095,062,060,130330 DATA 087,120,245,006,001,005,241,245,197,026,237,160,043340 DATA 119,035,012,013,032,246,235,014,064,009,193,237,066350 DATA 235,241,061,032,232,201360 WD$="1234567890123456789012345678901234567890123456789012345678"370 WD=VARPTR(WD$):WW=PEEK(WD+1)+PEEK(WD+2)*256380 FORI=WW TO WW+57:READ D:POKE I,D:NEXT390 DEFUSR=WW400 PRINT@24,"Reis-Routeplanning";410 PRINT@128,"Rec. Route                           GS>----< Pz Tijd  Ktot  KM%";420 PRINT@512,"Rec. Route                           GS>----< Pz Tijd  Ktot  KM%";430 PRINT@064,STRING$(64,"=");440 PRINT@448,STRING$(64,"-");450 PRINT@832,STRING$(64,"=");460 W1$=CHR$(151)+STRING$(14,131)+CHR$(171)470 V2$=C0+" Quit         "+C1480 W2$=C0+" Nieuwe Route "+C1490 W0$=C0+" Oude Route   "+C1500 W9$=C0+" Catalogus    "+C1510 V9$=C0+" REKENEN      "+C1520 W3$=CHR$(181)+STRING$(14,176)+CHR$(186)530 W4$=C0+" Open         "+C1540 W5$=C0+" Close        "+C1550 V5$=C0+" Scroll       "+C1560 W6$=C0+" Edit / Ins.  "+C1570 W7$=C0+" Save         "+C1580 W8$=C0+" Directory    "+C1590 V8$=C0+" Help         "+C1600 WN$=W1$+W2$+W1$+W4$+W5$+W6$+W7$+W3$610 WO$=W1$+W0$+W1$+W4$+V5$+W8$+W3$620 WC$=W1$+W9$+W1$+W4$+W5$+W6$+W7$+W8$+W3$630 WQ$=W1$+V2$+W1$+V8$+V9$+W3$640 WY=8:WX=16:W$=CHR$(WY)+CHR$(WX)+WN$650 VY=5:VX=00:Z$(1)=CHR$(VY)+CHR$(VX)+W$660 WY=7:WX=16:W$=CHR$(WY)+CHR$(WX)+WO$670 VY=5:VX=16:Z$(2)=CHR$(VY)+CHR$(VX)+W$680 WY=9:WX=16:W$=CHR$(WY)+CHR$(WX)+WC$690 VY=5:VX=32:Z$(3)=CHR$(VY)+CHR$(VX)+W$700 WY=6:WX=16:W$=CHR$(WY)+CHR$(WX)+WQ$710 VY=5:VX=48:Z$(4)=CHR$(VY)+CHR$(VX)+W$720 GOSUB800:K=N:GOTO910730 QP$=INKEY$:IFQP$=""THEN730ELSEQP=ASC(QP$)740 IFQP=09THENGOSUB800:N=N+1:GOSUB800:K=N:GOTO910750 IFQP=08THENGOSUB800:N=N-1:GOSUB800:K=N:GOTO910760 IFQP=10THENK=K+4:GOTO830770 IFQP=91THENK=K-4:GOTO830780 IFQP=13THEN970790 GOTO730800 IFN>4THENN=1810 IFN<1THENN=4820 X$=USR(Z$(N)):RETURN830 IFK=17K=1840 IFK=-3K=13850 IFK=14K=2860 IFK=-2K=10870 IFK=23K=3880 IFK=-1K=19890 IFK=12K=0900 IFK=-4K=8910 PRINT@PL,CHR$(30);:PRINT@PS(K),;920 POKEVARPTR(B$),13930 POKEVARPTR(B$)+2,PEEK(16417):POKEVARPTR(B$)+1,PEEK(16416)940 B1$=B$950 PRINT@PS(K),A$;:FORT=1TO40:QP$=INKEY$:IFQP$=""THENNEXT:GOTO960:ELSEQP=ASC(QP$):PRINT@PS(K),B1$;:GOTO740960 PRINT@PS(K),B1$;:FORT=1TO40:QP$=INKEY$:IFQP$=""THENNEXT:GOTO950ELSEQP=ASC(QP$):PRINT@PS(K),B1$;:GOTO740970 REM980 ONK+1GOTO1000,1020,1110,1170,1210,1250,1230,1450,1480,1800,1280,2720,270,2760,270,2850,270,270,270,2880990 GOTO9801000 REM quit1010 GOSUB190:IFJN=1THENENDELSEGOTO9101020 REM open nieuwe file1030 FP=1:PR=128:EX$="/RTE":GOSUB60:NT$=RT$+STR$(DR):GOSUB1101040 IFF=-1PRINT@PL,CHR$(30);RT$" already exists - Continue (j/n)";:INPUTJN$:IFJN$="J"ORJN$="j"THENF=1:GOSUB170ELSERT$="":NT$="":GOTO9101050 IFF=1THENRT$=NT$:GOSUB1701060 X$=USR(Z$(N))1070 FORI=0TO3:RC=RC+1:GOSUB200:NEXT1080 I$=INKEY$:IFI$=""THEN10801090 X$=USR(Z$(N))1100 GOTO9101110 REM open oude file1120 FP=2:PR=512:EX$="/RTE":GOSUB60:OT$=RT$+STR$(DR):GOSUB1101130 IFF=1THENOT$=""1140 IFF=1PRINT@PL,CHR$(30);"Can't open ";RT$;" file.  Press <ENTER>";:INPUTJN$:GOTO9101150 IFF=-1THENF=1:GOSUB1701160 GOTO10601170 REM open catalog file1180 FP=3:PR=128:EX$="/CAT":GOSUB60:CT$=RT$+STR$(DR):GOSUB1101190 IFF=1THENCT$=""1200 GOTO11401210 REM1220 PRINT@PL,"Geen hulp aanwezig!!";:INPUTJN$;:GOTO9101230 REM Scroll1240 X$=USR(Z$(N)):PR=512:FP=2:IFOT$=""THENX$=USR(Z$(N)):K=2:GOTO910ELSEGOTO19201250 REM close1260 IFFP>0THENPRINT@PL,"New file closed";:CLOSE FP:NT$="":GOTO9101270 GOTO9101280 FP=1:X$=USR(Z$(N)):PRINT@PL,"Effe wachten....";:GOSUB1300:GOTO1390:REM dir ot en cat1290 FP=3:X$=USR(Z$(N)):PRINT@PL,"Effe wachten....";:GOSUB1300:GOTO1430:REM dir ot en cat1300 ONERRORGOTO13401310 OPEN"R",FP,"DIR/SYS":FIELD FP, 255 AS D1$1320 D1=01330 FORJ=3TOLOF(FP):GET FP,J1340 RESUME NEXT1350 FORI=0TO7:D1=D1+1:D$(D1)=MID$(D1$,I*32+1,16):NEXTI1360 NEXTJ1370 ONERRORGOTO01380 RETURN1390 PRINT@PL,CHR$(30);"";:FORI=1TOD1:IFRIGHT$(D$(I),3)="RTE"ANDASC(LEFT$(D$(I),1))<>0ANDD4<4THENPRINTMID$(D$(I),5,8),:D4=D4+1:GOSUB1420:NEXTELSENEXT1400 GOSUB1410:X$=USR(Z$(N)):GOTO9101410 I$=INKEY$:IFI$=""THEN1410ELSERETURN1420 IFD4>3THEND4=0:GOSUB1410:PRINT@PL,CHR$(30);:RETURNELSERETURN1430 PRINT@PL,CHR$(30);"";:FORI=1TOD1:IFRIGHT$(D$(I),3)="CAT"ANDASC(LEFT$(D$(I),1))<>0ANDD4<4THENPRINTMID$(D$(I),5,8),:D4=D4+1:GOSUB1420:NEXTELSENEXT1440 GOSUB1410:X$=USR(Z$(N)):GOTO9101450 REM close cat1460 IFFP>0THENPRINT@PL,"Close catalogus";:CLOSE FP:CT$="":GOTO9101470 GOTO9101480 REM rekenen1490 FP=1:PR=128:GS=80:KZ$="sumSUM"+CHR$(27)+CHR$(13):X$=USR(Z$(N))1500 PRINT@PL,CHR$(30);"Gem.snelheid:     km/uur               Vertrektijd:       uur";1510 GS$=STR$(GS):VU$=STR$(VU):VM$=STR$(VM):MID$(VU$,1,1)="0":MID$(VM$,1,1)="0":PRINT@PL+14,STRING$(3-(LEN(GS$)-1),"0")+RIGHT$(GS$,LEN(GS$)-1);:PRINT@PL+52,RIGHT$(VU$,2);":";RIGHT$(VM$,2);1520 PRINT@192,;1530 I$=INKEY$:IFI$=""THEN15301540 ONINSTR(KZ$,I$)GOTO1570,1590,1610,1630,1650,1670,1690,17001550 PRINT@PL,CHR$(30);"Snelheid/Uren/Minuten =>      s-u-m omlaag        S-U-M omhoog";1560 IFINKEY$=""THEN1560ELSE15001570 GS=GS-1:IFGS<5GS=51580 GOTO15101590 VU=VU-1:IFVU<0VU=231600 GOTO15101610 VM=VM-1:IFVM<0VM=591620 GOTO15101630 GS=GS+1:IFGS>180GS=1801640 GOTO15101650 VU=VU+1:IFVU>23VU=01660 GOTO15101670 VM=VM+1:IFVM>59VM=01680 GOTO15101690 X$=USR(Z$(N)):GOTO9101700 TA=0:TR=0:VT=VU*60+VM:AS=GS/60:IFNT$=""GOTO16901710 PRINT@PL,CHR$(30);"Moment a.u.b.";1720 FORRC=1TOLOF(FP):GET FP,RC,,(64)R$;:G1=VAL(MID$(R$,37,3)):KM=VAL(MID$(R$,40,5)):RU=VAL(MID$(R$,47,2)):TA=TA+KM:TR=TR+RU:IFG1<>0THENAS=G1/60ELSEAS=GS/601730 GT=INT(KM/AS+.5):K1=INT((KM)-((RU*AS))):G0=G0+GT:G2=VT+TR+G0:G3=INT(G2/60):G4=G2-G3*601740 IFG3>23THENG3=G3-24:GOTO17401750 G3$=STR$(G3):G4$=STR$(G4):TA$=STR$(TA):MID$(G3$,1,1)="0":MID$(G4$,1,1)="0":MID$(R$,50,5)=RIGHT$(G3$,2)+":"+RIGHT$(G4$,2):MID$(R$,56,4)=STRING$(4-(LEN(TA$)-1),"0")+RIGHT$(TA$,LEN(TA$)-1)1760 K1$=STR$(K1):IFLEN(K1$)=>3THENMID$(R$,61,4)=K1$1770 IFLEN(K1$)=2THENMID$(R$,62,3)=K1$1780 PUT FP,RC,,(64)R$;:NEXT1790 I$=CHR$(91):B=1:PRINT@PL,CHR$(30);:R=0:RC=0:FORI=1TO4:RC=RC+1:GOSUB200:NEXT:GOTO20101800 REM Edit nw. route1810 FP=1:IFNT$=""THENK=1:GOTO9101820 N1$="=============>":N1$=RIGHT$(N1$,LEN(NT$)):PR=128:RT$=NT$1830 X$=USR(Z$(N))1840 PRINT@PL,CHR$(30);:PRINT@PL+14,"  <S>croll  <E>dit   <I>nsert  <D>el   Dra<G>";1850 PRINT@PL,N1$;:FORT=1TO50:IN$=INKEY$:IFIN$=""THENNEXT:ELSE18701860 PRINT@PL,NT$;:FORT=1TO50:IN$=INKEY$:IFIN$=""THENNEXT:GOTO18501870 IN=INT(INSTR(" SsEeIiDdGg",IN$)/2)1880 ONINGOTO1910,2040,2190,2210,24001890 IFN2=1THENNT$=N2$:N2=0:X$=USR(Z$(N)):GOTO9101900 X$=USR(Z$(N)):GOTO9101910 REM scroll1920 PRINT@PL,CHR$(30);:B=1:GOTO20101930 I$=INKEY$1940 IFI$=""THENPOKES,191:POKES,S1:GOTO1930ELSEA=ASC(I$)1950 IFA=91ANDB=1THENPOKEVARPTR(RC$)+2,S3:POKEVARPTR(RC$)+1,S2:RC=VAL(RC$):RC=RC-2:R=0:FORI=1TO4:RC=RC+1:GOSUB200:NEXT1960 IFA=10ANDB=4THENPOKEVARPTR(RC$)+2,S3:POKEVARPTR(RC$)+1,S2:RC=VAL(RC$):RC=RC-3:R=0:FORI=1TO4:RC=RC+1:GOSUB200:NEXT1970 IFA=91ANDB>1THENB=B-11980 IFA=10ANDB<4THENB=B+11990 IFA=27THEN18402000 IFA=13THEN18902010 PRINT@PR+B*64,;2020 S2=PEEK(16416):S3=PEEK(16417):S=S3*256+S2:S1=PEEK(S)2030 GOTO19302040 REM edit nieuwe file2050 PRINT@PR,;:GOTO21502060 I$=INKEY$:IFI$=""THENPOKES,191:POKES,S1:GOTO20602070 A=ASC(I$)2080 IFA=91PRINTCHR$(27);:GOTO21502090 IFA=10PRINTCHR$(26);:GOTO21502100 IFA=08PRINTCHR$(24);:GOTO21502110 IFA=09PRINTCHR$(25);:GOTO21502120 IF(A=27ORA=13)ANDN2<>1THENK=13:GOSUB820:GOTO9102130 IF(A=27ORA=13)ANDN2=1THENK=15:N2=0:NT$=N2$:GOSUB820:GOTO9102140 PRINTI$;2150 S=PEEK(16417)*256+PEEK(16416):S1=PEEK(S)2160 IFS>=15360+448THENPRINTCHR$(27);:GOTO21502170 IFS<=15360+128THENPRINTCHR$(26);:GOTO21502180 GOTO20602190 REM insert nieuwe file record2200 A1=139:A0=1:GOTO22302210 REM delete nieuwe file record2220 A1=1342230 PRINT@PL,CHR$(30);:B=1:PR=128:B7$=STRING$(64,A1):B5$=STRING$(64,32):GOTO22902240 I$=INKEY$:IFI$=""THENPRINT@S-15360,B7$;:PRINT@S-15360,B6$;:GOTO2240ELSEA=ASC(I$)2250 IFA=91ANDB>1THENB=B-12260 IFA=10ANDB<4THENB=B+12270 IFA=13ANDA0=0THENA=0:PRINT@S-15360+5,STRING$(59,32);:GOTO27002280 IFA=13ANDA0=1THENA0=0:A=0:RC=VAL(LEFT$(B6$,5)):GOTO23402290 IFA=27THENA=0:GOTO18402300 PRINT@PR+B*64,;2310 S2=PEEK(16416):S3=PEEK(16417):S=S3*256+S2:S1=PEEK(S)2320 POKEVARPTR(B5$)+2,S3:POKEVARPTR(B5$)+1,S2:B6$=B5$2330 GOTO22402340 PRINT@PL,CHR$(30);:PRINT@PL,"Moment a.u.b.";2350 FORI=LOF(FP)+1 TO RC+1 STEP -1:IFI-1>0THENGET FP,I-1,,(64)R$;:ELSEGOTO23802360 R1$=STR$(I):MID$(R$,1,5)=LEFT$(R1$,1)+STRING$(3-(LEN(R1$)-1),"0")+RIGHT$(R1$,LEN(R1$)-1)2370 PUT FP,I,,(64)R$;2380 NEXT2390 PRINT@S-15360+5,STRING$(59,32);:PRINT@PL,CHR$(30);:IFI>0THENR$=LEFT$(B6$,5)+STRING$(59,32):PUT FP,I,,(64)R$;:GOTO1840ELSE18402400 REM drag2410 IFN2=1THENPRINT@PL,CHR$(30);"This option is not available";:INPUTJN$:GOTO18402420 PRINT@PL,CHR$(30);:B=1:PR=512:GOTO24702430 I$=INKEY$:IFI$=""THENPOKES,191:POKES,S1:GOTO2430ELSEA=ASC(I$)2440 IFA=91ANDB>1THENB=B-12450 IFA=10ANDB<4THENB=B+12460 IFA=13THENA=0:GOTO25102470 IFA=27THEN18402480 PRINT@PR+B*64,;2490 S=PEEK(16417)*256+PEEK(16416):S1=PEEK(S):GOTO24302500 GOTO24302510 B2$="":C2$="":L=64:PRINT@PR+B*64,;2520 S2=PEEK(16416):S3=PEEK(16417):S=S3*256+S2:S1=PEEK(S)2530 A2$=STRING$(L,191)2540 I$=INKEY$:IFI$<>""THENA=ASC(I$)2550 IFA=91ANDL>127THENL=L-64:A=0:GOTO26202560 IFA=10ANDL<191THENL=L+64:A=0:GOTO26202570 IFA=13ANDS+L<16256:A=0:GOTO26502580 IFA=27THENA=0:GOTO24802590 POKEVARPTR(B2$),L2600 POKEVARPTR(B2$)+2,S3:POKEVARPTR(B2$)+1,S2:B3$=B2$2610 PRINT@S-15360,A2$;2620 PRINT@S-15360,B3$;2630 GOTO25302640 I$=INKEY$:IFI$<>""THENA=ASC(I$)2650 IFA=91ANDS-15360>=256THENS=S-642660 IFA=10ANDS-15360+L<=896THENS=S+642670 IFA=13ANDS+L<15872THENPRINT@S-15360,B3$;:GOTO27002680 POKEVARPTR(C2$),L:POKEVARPTR(C2$)+2,INT(S/256):POKEVARPTR(C2$)+1,S-INT(S/256)*2562690 C3$=C2$:PRINT@S-15360,B3$;:PRINT@S-15360,A2$;:PRINT@S-15360,C3$;:A=0:GOTO26402700 X$=USR(Z$(N))2710 K=13:GOTO9102720 REM Edit en Insert Catalog-file2730 FP=3:N2$=NT$:NT$=CT$:N2=12740 IFNT$=""THENK=11:NT$=N2$:N2$="":GOTO9102750 GOTO18202760 REM save nieuwe file2770 IFNT$=""THENGOTO910ELSERT$=NT$:FP=1:GOTO27802780 X$=USR(Z$(N)):PRINT@PL,RT$;:INPUTI$:GOSUB190:IFJN=1THEN2790ELSEX$=USR(Z$(N)):GOTO9102790 B4$=STRING$(64,"X")2800 PRINT@PR,;2810 FORI=15552TO15744STEP64:POKEVARPTR(B4$)+2,INT(I/256):POKEVARPTR(B4$)+1,I-INT(I/256)*256:B5$=B4$:RC=VAL(LEFT$(B5$,5))2820 IFRC>0THEN PUT FP,RC,,(64)B5$;2830 NEXT2840 X$=USR(Z$(N)):GOTO9102850 REM save catalog file2860 IFCT$=""THENGOTO910ELSERT$=CT$:FP=3:GOTO27802870 GOTO9102880 REM dir catalog2890 GOTO1290